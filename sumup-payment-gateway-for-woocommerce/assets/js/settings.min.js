const connectButton=document.getElementById("sumup-payment-settings-connect"),disconnectButton=document.getElementById("sumup-payment-settings-disconnect"),noticeBanner=document.getElementById("sumup_notice");async function requestCoonection(){const n=new URLSearchParams({action:"sumup_connect",nonce:sumup_settings_ajax.nonce}),e=new Headers;e.append("Content-Type","application/x-www-form-urlencoded"),e.append("Credentials","same-origin");const t=await fetch(sumup_settings_ajax.ajax_url,{method:"POST",headers:e,body:n});if(!t.ok){buttonLoading(connectButton,"disable");const n=await t.json();throw noticeBanner&&(noticeBanner.classList.add("sumup_notice--show"),noticeBanner.querySelector(".sumup-notice__message").innerText=n.data.detail||"Unknown error occurred."),new Error(`HTTP error! status: ${t.status}`)}const o=await t.json();return 422===o.status&&noticeBanner?(buttonLoading(connectButton,"disable"),noticeBanner.classList.add("sumup_notice--show"),void(noticeBanner.querySelector(".sumup-notice__message").innerText=o.detail)):!o.redirect_url&noticeBanner?(buttonLoading(connectButton,"disable"),noticeBanner.classList.add("sumup_notice--show"),void(noticeBanner.querySelector(".sumup-notice__message").innerText=o.detail)):void(window.location.href=o.redirect_url)}async function requestDisconnection(){const n=new URLSearchParams({action:"sumup_disconnect",nonce:sumup_settings_ajax.nonce}),e=new Headers;e.append("Content-Type","application/x-www-form-urlencoded"),e.append("Credentials","same-origin");const t=await fetch(sumup_settings_ajax.rest_api_url_disconnect,{method:"POST",headers:e,body:n});if(!t.ok)throw buttonLoading(disconnectButton,"disable"),noticeBanner&&(noticeBanner.classList.add("sumup_notice--show"),noticeBanner.querySelector(".sumup-notice__message").innerText=t),new Error(`HTTP error! status: ${t.status}`);const o=await t.json();return 422===o.status&&noticeBanner?(buttonLoading(disconnectButton,"disable"),noticeBanner.classList.add("sumup_notice--show"),void(noticeBanner.querySelector(".sumup-notice__message").innerText=o.detail)):!o.redirect_url&noticeBanner?(buttonLoading(disconnectButton,"disable"),noticeBanner.classList.add("sumup_notice--show"),void(noticeBanner.querySelector(".sumup-notice__message").innerText=o.detail)):void(window.location.href=o.redirect_url)}function buttonLoading(n,e="enable"){"enable"===e&&(n.innerHTML='<span class="sumup-button-loading"></span>'),"disable"===e&&(n.innerText=n.dataset.text)}connectButton&&connectButton.addEventListener("click",n=>{n.preventDefault(),buttonLoading(connectButton,"enable"),noticeBanner&&noticeBanner.classList.remove("sumup_notice--show"),requestCoonection()}),disconnectButton&&disconnectButton.addEventListener("click",n=>{n.preventDefault(),buttonLoading(disconnectButton,"enable"),noticeBanner&&noticeBanner.classList.remove("sumup_notice--show"),requestDisconnection()});const secondaryButton=document.getElementById("sumup-modal-button-secondary");secondaryButton&&secondaryButton.addEventListener("click",n=>{const e=document.querySelector(".wc-admin-breadcrumb");e&&e.scrollIntoView({behavior:"smooth",block:"start"})});